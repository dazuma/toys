<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Toys::StandardMixins::Exec
  
    &mdash; Toys
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Toys::StandardMixins::Exec";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (E)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Toys.html" title="Toys (module)">Toys</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../StandardMixins.html" title="Toys::StandardMixins (module)">StandardMixins</a></span></span>
     &raquo; 
    <span class="title">Exec</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Toys::StandardMixins::Exec
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="../Mixin.html" title="Toys::Mixin (module)">Mixin</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/toys/standard_mixins/exec.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>The <code>:exec</code> mixin provides set of helper methods for executing processes
and subcommands. It provides shortcuts for common cases such as invoking
a Ruby script in a subprocess or capturing output in a string. It also
provides an interface for controlling a spawned process&#39;s streams.</p>

<p>You can make these methods available to your tool by including the
following directive in your tool configuration:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_include'>include</span> <span class='symbol'>:exec</span>
</code></pre>

<p>This is a frontend for <span class='object_link'><a href="../Utils/Exec.html" title="Toys::Utils::Exec (class)">Utils::Exec</a></span>. More information is
available in that class&#39;s documentation.</p>

<h3 id="mixin-overview">Mixin overview</h3>

<p>The mixin provides a number of methods for spawning processes. The most
basic are <span class='object_link'><a href="#exec-instance_method" title="Toys::StandardMixins::Exec#exec (method)">#exec</a></span> and <span class='object_link'><a href="#exec_proc-instance_method" title="Toys::StandardMixins::Exec#exec_proc (method)">#exec_proc</a></span>. The <span class='object_link'><a href="#exec-instance_method" title="Toys::StandardMixins::Exec#exec (method)">#exec</a></span> method spawns an
operating system process specified by an executable and a set of
arguments. The <span class='object_link'><a href="#exec_proc-instance_method" title="Toys::StandardMixins::Exec#exec_proc (method)">#exec_proc</a></span> method takes a <code>Proc</code> and forks a Ruby
process. Both of these can be heavily configured with stream handling,
result handling, and numerous other options described below. The mixin
also provides convenience methods for common cases such as spawning a
Ruby process, spawning a shell script, or capturing output.</p>

<p>The mixin also stores default configuration that it applies to processes
it spawns. You can change these defaults by calling <span class='object_link'><a href="#configure_exec-instance_method" title="Toys::StandardMixins::Exec#configure_exec (method)">#configure_exec</a></span>.</p>

<p>Underlying the mixin is a service object of type <span class='object_link'><a href="../Utils/Exec.html" title="Toys::Utils::Exec (class)">Utils::Exec</a></span>.
Normally you would use the mixin methods to access this functionality,
but you can also retrieve the service object itself by calling
<span class='object_link'><a href="../Context.html#get-instance_method" title="Toys::Context#get (method)">Context#get</a></span> with the key <span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span>.</p>

<h3 id="controlling-processes">Controlling processes</h3>

<p>A process can be started in the <em>foreground</em> or the <em>background</em>. If you
start a foreground process, it will &quot;take over&quot; your standard input and
output streams by default, and it will keep control until it completes.
If you start a background process, its streams will be redirected to null
by default, and control will be returned to you immediately.</p>

<p>While a process is running, you can control it using a
<span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> object. Use a controller to interact with
the process&#39;s input and output streams, send it signals, or wait for it
to complete.</p>

<p>When running a process in the foreground, the controller will be yielded
to an optional block. For example, the following code starts a process in
the foreground and passes its output stream to a controller.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>git</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>init</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>out:</span> <span class='symbol'>:controller</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_controller'>controller</span><span class='op'>|</span>
  <span class='id identifier rubyid_loop'>loop</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='id identifier rubyid_controller'>controller</span><span class='period'>.</span><span class='id identifier rubyid_out'>out</span><span class='period'>.</span><span class='id identifier rubyid_gets'>gets</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Got line: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_line'>line</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>When running a process in the background, the controller is returned from
the method that starts the process:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_controller'>controller</span> <span class='op'>=</span> <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>git</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>init</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>background:</span> <span class='kw'>true</span><span class='rparen'>)</span>
</code></pre>

<h3 id="stream-handling">Stream handling</h3>

<p>By default, subprocess streams are connected to the corresponding streams
in the parent process. You can change this behavior, redirecting streams
or providing ways to control them, using the <code>:in</code>, <code>:out</code>, and <code>:err</code>
options.</p>

<p>Three general strategies are available for custom stream handling. First,
you can redirect to other streams such as files, IO objects, or Ruby
strings. Some of these options map directly to options provided by the
<code>Process#spawn</code> method. Second, you can use a controller to manipulate
the streams programmatically. Third, you can capture output stream data
and make it available in the result.</p>

<p>Following is a full list of the stream handling options, along with how
to specify them using the <code>:in</code>, <code>:out</code>, and <code>:err</code> options.</p>

<ul>
<li><p><strong>Inherit parent stream:</strong> You can inherit the corresponding stream
in the parent process by passing <code>:inherit</code> as the option value. This
is the default if the subprocess is <em>not</em> run in the background.</p></li>
<li><p><strong>Redirect to null:</strong> You can redirect to a null stream by passing
<code>:null</code> as the option value. This connects to a stream that is not
closed but contains no data, i.e. <code>/dev/null</code> on unix systems. This
is the default if the subprocess is run in the background.</p></li>
<li><p><strong>Close the stream:</strong> You can close the stream by passing <code>:close</code> as
the option value. This is the same as passing <code>:close</code> to
<code>Process#spawn</code>.</p></li>
<li><p><strong>Redirect to a file:</strong> You can redirect to a file. This reads from
an existing file when connected to <code>:in</code>, and creates or appends to a
file when connected to <code>:out</code> or <code>:err</code>. To specify a file, use the
setting <code>[:file, &quot;/path/to/file&quot;]</code>. You can also, when writing a
file, append an optional mode and permission code to the array. For
example, <code>[:file, &quot;/path/to/file&quot;, &quot;a&quot;, 0644]</code>.</p></li>
<li><p><strong>Redirect to an IO object:</strong> You can redirect to an IO object in the
parent process, by passing the IO object as the option value. You can
use any IO object. For example, you could connect the child&#39;s output
to the parent&#39;s error using <code>out: $stderr</code>, or you could connect to
an existing File stream. Unlike <code>Process#spawn</code>, this works for IO
objects that do not have a corresponding file descriptor (such as
StringIO objects). In such a case, a thread will be spawned to pipe
the IO data through to the child process.</p></li>
<li><p><strong>Redirect to a pipe:</strong> You can redirect to a pipe created using
<code>IO.pipe</code> (i.e. a two-element array of read and write IO objects) by
passing the array as the option value. This will connect the
appropriate IO (either read or write), and close it in the parent.
Thus, you can connect only one process to each end. If you want more
direct control over IO closing behavior, pass the IO object (i.e. the
element of the pipe array) directly.</p></li>
<li><p><strong>Combine with another child stream:</strong> You can redirect one child
output stream to another, to combine them. To merge the child&#39;s error
stream into its output stream, use <code>err: [:child, :out]</code>.</p></li>
<li><p><strong>Read from a string:</strong> You can pass a string to the input stream by
setting <code>[:string, &quot;the string&quot;]</code>. This works only for <code>:in</code>.</p></li>
<li><p><strong>Capture output stream:</strong> You can capture a stream and make it
available on the <span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Utils::Exec::Result</a></span> object, using the
setting <code>:capture</code>. This works only for the <code>:out</code> and <code>:err</code>
streams.</p></li>
<li><p><strong>Use the controller:</strong> You can hook a stream to the controller using
the setting <code>:controller</code>. You can then manipulate the stream via the
controller. If you pass a block to <span class='object_link'><a href="#exec-instance_method" title="Toys::StandardMixins::Exec#exec (method)">#exec</a></span>,
it yields the <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span>, giving you access to
streams.</p></li>
<li><p><strong>Make copies of an output stream:</strong> You can &quot;tee,&quot; or duplicate the
<code>:out</code> or <code>:err</code> stream and redirect those copies to various
destinations. To specify a tee, use the setting <code>[:tee, ...]</code> where
the additional array elements include two or more of the following.
See the corresponding documentation above for more detail.</p>

<ul>
<li> <code>:inherit</code> to direct to the parent process&#39;s stream.</li>
<li> <code>:capture</code> to capture the stream and store it in the result.</li>
<li> <code>:controller</code> to direct the stream to the controller.</li>
<li> <code>[:file, &quot;/path/to/file&quot;]</code> to write to a file.</li>
<li> An <code>IO</code> or <code>StringIO</code> object.</li>
<li> An array of two <code>IO</code> objects representing a pipe</li>
</ul>

<p>Additionally, the last element of the array can be a hash of options.
Supported options include:</p>

<ul>
<li> <code>:buffer_size</code> The size of the memory buffer for each element of
the tee. Larger buffers may allow higher throughput. The default
is 65536.</li>
</ul></li>
</ul>

<h3 id="result-handling">Result handling</h3>

<p>A subprocess result is represented by a <span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Utils::Exec::Result</a></span>
object, which includes the exit code, the content of any captured output
streams, and any exeption raised when attempting to run the process.
When you run a process in the foreground, the method will return a result
object. When you run a process in the background, you can obtain the
result from the controller once the process completes.</p>

<p>The following example demonstrates running a process in the foreground
and getting the exit code:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>git</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>init</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exit code: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exit_code'>exit_code</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>The following example demonstrates starting a process in the background,
waiting for it to complete, and getting its exit code:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_controller'>controller</span> <span class='op'>=</span> <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>git</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>init</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>background:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_controller'>controller</span><span class='period'>.</span><span class='id identifier rubyid_result'>result</span><span class='lparen'>(</span><span class='label'>timeout:</span> <span class='float'>1.0</span><span class='rparen'>)</span>
<span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exit code: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exit_code'>exit_code</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>else</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>timed out</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>You can also provide a callback that is executed once a process
completes. This callback can be specified as a method name or a <code>Proc</code>
object, and will be passed the result object. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='kw'>def</span> <span class='id identifier rubyid_run'>run</span>
  <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>git</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>init</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>result_callback:</span> <span class='symbol'>:handle_result</span><span class='rparen'>)</span>
<span class='kw'>end</span>
<span class='kw'>def</span> <span class='id identifier rubyid_handle_result'>handle_result</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exit code: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exit_code'>exit_code</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
</code></pre>

<p>Finally, you can force your tool to exit if a subprocess fails, similar
to setting the <code>set -e</code> option in bash, by setting the
<code>:exit_on_nonzero_status</code> option. This is often set as a default
configuration for all subprocesses run in a tool, by passing it as an
argument to the <code>include</code> directive:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_include'>include</span> <span class='symbol'>:exec</span><span class='comma'>,</span> <span class='label'>exit_on_nonzero_status:</span> <span class='kw'>true</span>
</code></pre>

<h3 id="configuration-options">Configuration Options</h3>

<p>A variety of options can be used to control subprocesses. These can be
provided to any method that starts a subprocess. You can also set
defaults by passing them as keyword arguments when you <code>include</code> the
mixin.</p>

<p>Options that affect the behavior of subprocesses:</p>

<ul>
<li><p><code>:env</code> (Hash) Environment variables to pass to the subprocess.
Keys represent variable names and should be strings. Values should be
either strings or <code>nil</code>, which unsets the variable.</p></li>
<li><p><code>:background</code> (Boolean) Runs the process in the background if <code>true</code>.</p></li>
</ul>

<p>Options related to handling results</p>

<ul>
<li><p><code>:result_callback</code> (Proc,Symbol) A procedure that is called, and
passed the result object, when the subprocess exits. You can provide
a <code>Proc</code> object, or the name of a method as a <code>Symbol</code>.</p></li>
<li><p><code>:exit_on_nonzero_status</code> (Boolean) If set to true, a nonzero exit
code will cause the tool to exit immediately with that same code.</p></li>
<li><p><code>:e</code> (Boolean) A short name for <code>:exit_on_nonzero_status</code>.</p></li>
</ul>

<p>Options for connecting input and output streams. See the section above on
stream handling for info on the values that can be passed.</p>

<ul>
<li><p><code>:in</code> Connects the input stream of the subprocess. See the section on
stream handling.</p></li>
<li><p><code>:out</code> Connects the standard output stream of the subprocess. See the
section on stream handling.</p></li>
<li><p><code>:err</code> Connects the standard error stream of the subprocess. See the
section on stream handling.</p></li>
</ul>

<p>Options related to logging and reporting:</p>

<ul>
<li><p><code>:logger</code> (Logger) Logger to use for logging the actual command. If
not present, the command is not logged.</p></li>
<li><p><code>:log_level</code> (Integer,false) Level for logging the actual command.
Defaults to Logger::INFO if not present. You can also pass <code>false</code> to
disable logging of the command.</p></li>
<li><p><code>:log_cmd</code> (String) The string logged for the actual command.
Defaults to the <code>inspect</code> representation of the command.</p></li>
<li><p><code>:name</code> (Object) An optional object that can be used to identify this
subprocess. It is available in the controller and result objects.</p></li>
</ul>

<p>In addition, the following options recognized by
<a href="https://ruby-doc.org/core/Process.html#method-c-spawn"><code>Process#spawn</code></a>
are supported.</p>

<ul>
<li><p><code>:chdir</code> (String) Set the working directory for the command.</p></li>
<li><p><code>:close_others</code> (Boolean) Whether to close non-redirected
non-standard file descriptors.</p></li>
<li><p><code>:new_pgroup</code> (Boolean) Create new process group (Windows only).</p></li>
<li><p><code>:pgroup</code> (Integer,true,nil) The process group setting.</p></li>
<li><p><code>:umask</code> (Integer) Umask setting for the new process.</p></li>
<li><p><code>:unsetenv_others</code> (Boolean) Clear environment variables except those
explicitly set.</p></li>
</ul>

<p>Any other option key will result in an <code>ArgumentError</code>.</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="KEY-constant" class="">KEY =
          <div class="docstring">
  <div class="discussion">
    <p>Context key for the executor object.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='op'>::</span><span class='const'>Object</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture-instance_method" title="#capture (instance method)">#<strong>capture</strong>(cmd, **opts) {|controller| ... } &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a command.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture_proc-instance_method" title="#capture_proc (instance method)">#<strong>capture_proc</strong>(func, **opts) {|controller| ... } &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a proc in a forked subprocess.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture_ruby-instance_method" title="#capture_ruby (instance method)">#<strong>capture_ruby</strong>(args, **opts) {|controller| ... } &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Spawn a ruby process and pass the given arguments to it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture_separate_tool-instance_method" title="#capture_separate_tool (instance method)">#<strong>capture_separate_tool</strong>(cmd, **opts) {|controller| ... } &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a tool in a separately spawned process.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#capture_tool-instance_method" title="#capture_tool (instance method)">#<strong>capture_tool</strong>(cmd, **opts) {|controller| ... } &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a tool in the current CLI in a forked process.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#configure_exec-instance_method" title="#configure_exec (instance method)">#<strong>configure_exec</strong>(**opts)  &#x21d2; self </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Set default configuration options.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exec-instance_method" title="#exec (instance method)">#<strong>exec</strong>(cmd, **opts) {|controller| ... } &#x21d2; Toys::Utils::Exec::Controller, Toys::Utils::Exec::Result </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a command.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exec_proc-instance_method" title="#exec_proc (instance method)">#<strong>exec_proc</strong>(func, **opts) {|controller| ... } &#x21d2; Toys::Utils::Exec::Controller, Toys::Utils::Exec::Result </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a proc in a forked subprocess.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exec_ruby-instance_method" title="#exec_ruby (instance method)">#<strong>exec_ruby</strong>(args, **opts) {|controller| ... } &#x21d2; Toys::Utils::Exec::Controller, Toys::Utils::Exec::Result </a>
    

    
      (also: #ruby)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Spawn a ruby process and pass the given arguments to it.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exec_separate_tool-instance_method" title="#exec_separate_tool (instance method)">#<strong>exec_separate_tool</strong>(cmd, **opts) {|controller| ... } &#x21d2; Toys::Utils::Exec::Controller, Toys::Utils::Exec::Result </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a tool in a separately spawned process.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exec_tool-instance_method" title="#exec_tool (instance method)">#<strong>exec_tool</strong>(cmd, **opts) {|controller| ... } &#x21d2; Toys::Utils::Exec::Controller, Toys::Utils::Exec::Result </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute a tool in the current CLI in a forked process.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exit_on_nonzero_status-instance_method" title="#exit_on_nonzero_status (instance method)">#<strong>exit_on_nonzero_status</strong>(status)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Exit if the given status code is nonzero.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sh-instance_method" title="#sh (instance method)">#<strong>sh</strong>(cmd, **opts) {|controller| ... } &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Execute the given string in a shell.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#verbosity_flags-instance_method" title="#verbosity_flags (instance method)">#<strong>verbosity_flags</strong>(short: false)  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns an array of standard verbosity flags needed to replicate the current verbosity level.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Mixin.html" title="Toys::Mixin (module)">Mixin</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Mixin.html#create-class_method" title="Toys::Mixin.create (method)">create</a></span></p>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="capture-instance_method">
  
    #<strong>capture</strong>(cmd, **opts) {|controller| ... } &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a command. The command can be given as a single string to pass
to a shell, or an array of strings indicating a posix command.</p>

<p>Captures standard out and returns it as a string.
Cannot be run in the background.</p>

<p>If a block is provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be
yielded to it.</p>

<h3 id="example">Example</h3>

<p>Capture the output of an echo command</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_capture'>capture</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>echo</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hello\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_str'>str</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command to execute.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>What was written to standard out.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


518
519
520
521</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 518</span>

<span class='kw'>def</span> <span class='id identifier rubyid_capture'>capture</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_capture'>capture</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="capture_proc-instance_method">
  
    #<strong>capture_proc</strong>(func, **opts) {|controller| ... } &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a proc in a forked subprocess.</p>

<p>Captures standard out and returns it as a string.
Cannot be run in the background.</p>

<p>If a block is provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be
yielded to it.</p>

<p>Beware that some Ruby environments (e.g. JRuby, and Ruby on Windows)
do not support this method because they do not support fork.</p>

<h3 id="example">Example</h3>

<p>Run a proc in a forked process and capture its output:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_pid'>pid</span>
<span class='kw'>end</span>
<span class='id identifier rubyid_forked_pid'>forked_pid</span> <span class='op'>=</span> <span class='id identifier rubyid_capture_proc'>capture_proc</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_chomp'>chomp</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>I forked PID </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_forked_pid'>forked_pid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>func</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The proc to call.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>What was written to standard out.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


586
587
588
589</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 586</span>

<span class='kw'>def</span> <span class='id identifier rubyid_capture_proc'>capture_proc</span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_capture_proc'>capture_proc</span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="capture_ruby-instance_method">
  
    #<strong>capture_ruby</strong>(args, **opts) {|controller| ... } &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Spawn a ruby process and pass the given arguments to it.</p>

<p>Captures standard out and returns it as a string.
Cannot be run in the background.</p>

<p>If a block is provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be
yielded to it.</p>

<h3 id="example">Example</h3>

<p>Capture the output of a ruby script.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_capture_ruby'>capture_ruby</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-e</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(1..3).each { |i| puts i }</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_assert_equal'>assert_equal</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1\n2\n3\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_str'>str</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The arguments to ruby.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>What was written to standard out.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


549
550
551
552</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 549</span>

<span class='kw'>def</span> <span class='id identifier rubyid_capture_ruby'>capture_ruby</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_capture_ruby'>capture_ruby</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="capture_separate_tool-instance_method">
  
    #<strong>capture_separate_tool</strong>(cmd, **opts) {|controller| ... } &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a tool in a separately spawned process.</p>

<p>Captures standard out and returns it as a string.
Cannot be run in the background.</p>

<p>The command can be given as a single string or an array of strings,
representing the tool to run and the arguments to pass.</p>

<p>If a block is provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be
yielded to it.</p>

<p>An entirely separate spawned process is run for this tool, using the
setting of <span class='object_link'><a href="../../Toys.html#executable_path-class_method" title="Toys.executable_path (method)">Toys.executable_path</a></span>. Thus, this method can be run only if
that setting is present. The normal Toys gem does set it, but if you
are writing your own executable using Toys-Core, you will need to set
it explicitly for this method to work. Furthermore, Bundler, if
present, is reset to its &quot;unbundled&quot; environment. Thus, the tool found,
the behavior of the CLI, and the gem environment, might not be the same
as those of the calling tool.</p>

<p>This method is often used if you are already in a bundle and need to
run a tool that uses a different bundle. It may also be necessary on
environments without &quot;fork&quot; (such as JRuby or Ruby on Windows).</p>

<h3 id="example">Example</h3>

<p>Run the &quot;system version&quot; tool and capture its output.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_capture_separate_tool'>capture_separate_tool</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>system</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_chomp'>chomp</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Version was </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_str'>str</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The tool to execute.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>What was written to standard out.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


671
672
673
674
675
676</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 671</span>

<span class='kw'>def</span> <span class='id identifier rubyid_capture_separate_tool'>capture_separate_tool</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_clean_process'>_setup_clean_process</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_clean_cmd'>clean_cmd</span><span class='op'>|</span>
    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_capture'>capture</span><span class='lparen'>(</span><span class='id identifier rubyid_clean_cmd'>clean_cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="capture_tool-instance_method">
  
    #<strong>capture_tool</strong>(cmd, **opts) {|controller| ... } &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a tool in the current CLI in a forked process.</p>

<p>Captures standard out and returns it as a string.
Cannot be run in the background.</p>

<p>The command can be given as a single string or an array of strings,
representing the tool to run and the arguments to pass.</p>

<p>If a block is provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be
yielded to it.</p>

<p>Beware that some Ruby environments (e.g. JRuby, and Ruby on Windows)
do not support this method because they do not support fork.</p>

<h3 id="example">Example</h3>

<p>Run the &quot;system version&quot; tool and capture its output.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='id identifier rubyid_capture_tool'>capture_tool</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>system</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_chomp'>chomp</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Version was </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_str'>str</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The tool to execute.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>What was written to standard out.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


623
624
625
626
627</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 623</span>

<span class='kw'>def</span> <span class='id identifier rubyid_capture_tool'>capture_tool</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_func'>func</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__make_tool_caller'>_make_tool_caller</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_capture_proc'>capture_proc</span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="configure_exec-instance_method">
  
    #<strong>configure_exec</strong>(**opts)  &#x21d2; <tt>self</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Set default configuration options.</p>

<p>See the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation for a
description of the options.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The default options.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


294
295
296
297
298</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 294</span>

<span class='kw'>def</span> <span class='id identifier rubyid_configure_exec'>configure_exec</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_configure_defaults'>configure_defaults</span><span class='lparen'>(</span><span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exec-instance_method">
  
    #<strong>exec</strong>(cmd, **opts) {|controller| ... } &#x21d2; <tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>, <tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a command. The command can be given as a single string to pass
to a shell, or an array of strings indicating a posix command.</p>

<p>If the process is not set to run in the background, and a block is
provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be yielded to it.</p>

<h3 id="examples">Examples</h3>

<p>Run a command without a shell, and print the exit code (0 for success):</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>git</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>init</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exit code: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exit_code'>exit_code</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
</code></pre>

<p>Run a shell command:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cd mydir &amp;&amp; git init</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exit code: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_exit_code'>exit_code</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command to execute.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The subprocess controller, if
the process is running in the background.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The result, if the process ran in
the foreground.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 332</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exec_proc-instance_method">
  
    #<strong>exec_proc</strong>(func, **opts) {|controller| ... } &#x21d2; <tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>, <tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a proc in a forked subprocess.</p>

<p>If the process is not set to run in the background, and a block is
provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be yielded to it.</p>

<p>Beware that some Ruby environments (e.g. JRuby, and Ruby on Windows)
do not support this method because they do not support fork.</p>

<h3 id="example">Example</h3>

<p>Run a proc in a forked process.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_code'>code</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Spawned process ID is </span><span class='embexpr_beg'>#{</span><span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_pid'>pid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Main process ID is </span><span class='embexpr_beg'>#{</span><span class='const'>Process</span><span class='period'>.</span><span class='id identifier rubyid_pid'>pid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_exec_proc'>exec_proc</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>func</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The proc to call.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The subprocess controller, if
the process is running in the background.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The result, if the process ran in
the foreground.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


400
401
402
403</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 400</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exec_proc'>exec_proc</span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_exec_proc'>exec_proc</span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exec_ruby-instance_method">
  
    #<strong>exec_ruby</strong>(args, **opts) {|controller| ... } &#x21d2; <tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>, <tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='ruby-instance_method'>ruby</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Spawn a ruby process and pass the given arguments to it.</p>

<p>If the process is not set to run in the background, and a block is
provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be yielded to it.</p>

<h3 id="example">Example</h3>

<p>Execute a small script with warnings</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_exec_ruby'>exec_ruby</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-w</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-e</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>(1..10).each { |i| puts i }</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The arguments to ruby.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The subprocess controller, if
the process is running in the background.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The result, if the process ran in
the foreground.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


362
363
364
365</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 362</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exec_ruby'>exec_ruby</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_exec_ruby'>exec_ruby</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exec_separate_tool-instance_method">
  
    #<strong>exec_separate_tool</strong>(cmd, **opts) {|controller| ... } &#x21d2; <tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>, <tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a tool in a separately spawned process.</p>

<p>The command can be given as a single string or an array of strings,
representing the tool to run and the arguments to pass.</p>

<p>If the process is not set to run in the background, and a block is
provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be yielded to it.</p>

<p>An entirely separate spawned process is run for this tool, using the
setting of <span class='object_link'><a href="../../Toys.html#executable_path-class_method" title="Toys.executable_path (method)">Toys.executable_path</a></span>. Thus, this method can be run only if
that setting is present. The normal Toys gem does set it, but if you
are writing your own executable using Toys-Core, you will need to set
it explicitly for this method to work. Furthermore, Bundler, if
present, is reset to its &quot;unbundled&quot; environment. Thus, the tool found,
the behavior of the CLI, and the gem environment, might not be the same
as those of the calling tool.</p>

<p>This method is often used if you are already in a bundle and need to
run a tool that uses a different bundle. It may also be necessary on
environments without &quot;fork&quot; (such as JRuby or Ruby on Windows).</p>

<h3 id="example">Example</h3>

<p>Run the &quot;system update&quot; tool and pass it an argument.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_exec_separate_tool'>exec_separate_tool</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>system</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>update</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--verbose</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The tool to execute.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The subprocess controller, if
the process is running in the background.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The result, if the process ran in
the foreground.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


484
485
486
487
488
489</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 484</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exec_separate_tool'>exec_separate_tool</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_clean_process'>_setup_clean_process</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_clean_cmd'>clean_cmd</span><span class='op'>|</span>
    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_exec'>exec</span><span class='lparen'>(</span><span class='id identifier rubyid_clean_cmd'>clean_cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exec_tool-instance_method">
  
    #<strong>exec_tool</strong>(cmd, **opts) {|controller| ... } &#x21d2; <tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>, <tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute a tool in the current CLI in a forked process.</p>

<p>The command can be given as a single string or an array of strings,
representing the tool to run and the arguments to pass.</p>

<p>If the process is not set to run in the background, and a block is
provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be yielded to it.</p>

<p>Beware that some Ruby environments (e.g. JRuby, and Ruby on Windows)
do not support this method because they do not support fork.</p>

<h3 id="example">Example</h3>

<p>Run the &quot;system update&quot; tool and pass it an argument.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_exec_tool'>exec_tool</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>system</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>update</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--verbose</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The tool to execute.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The subprocess controller, if
the process is running in the background.</p>
</div>
      
    </li>
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The result, if the process ran in
the foreground.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


436
437
438
439
440
441</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 436</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exec_tool'>exec_tool</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_func'>func</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__make_tool_caller'>_make_tool_caller</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>log_cmd:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>exec tool: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_cmd'>cmd</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_exec_proc'>exec_proc</span><span class='lparen'>(</span><span class='id identifier rubyid_func'>func</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exit_on_nonzero_status-instance_method">
  
    #<strong>exit_on_nonzero_status</strong>(status)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Exit if the given status code is nonzero. Otherwise, returns 0.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>status</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>Process::Status</tt>, <tt><span class='object_link'><a href="../Utils/Exec/Result.html" title="Toys::Utils::Exec::Result (class)">Toys::Utils::Exec::Result</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


713
714
715
716
717
718</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 713</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exit_on_nonzero_status'>exit_on_nonzero_status</span><span class='lparen'>(</span><span class='id identifier rubyid_status'>status</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_exit_code'>exit_code</span> <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:exit_code</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_exitstatus'>exitstatus</span> <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='symbol'>:exitstatus</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../Context.html" title="Toys::Context (class)">Context</a></span></span><span class='period'>.</span><span class='id identifier rubyid_exit'><span class='object_link'><a href="../Context.html#exit-class_method" title="Toys::Context.exit (method)">exit</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_status'>status</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_zero?'>zero?</span>
  <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sh-instance_method">
  
    #<strong>sh</strong>(cmd, **opts) {|controller| ... } &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Execute the given string in a shell. Returns the exit code.
Cannot be run in the background.</p>

<p>If a block is provided, a <span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Utils::Exec::Controller</a></span> will be
yielded to it.</p>

<h3 id="example">Example</h3>

<p>Run a shell script</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_exit_code'>exit_code</span> <span class='op'>=</span> <span class='id identifier rubyid_sh'>sh</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cd mydir &amp;&amp; git init</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_exit_code'>exit_code</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Success!</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed!</span><span class='tstring_end'>&quot;</span></span>
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>cmd</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The shell command to execute.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>keywords</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The command options. See the section on
Configuration Options in the <span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module
documentation.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>controller</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Utils/Exec/Controller.html" title="Toys::Utils::Exec::Controller (class)">Toys::Utils::Exec::Controller</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A controller for
the subprocess. See the section on Controlling Processes in the
<span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Toys::StandardMixins::Exec</a></span> module documentation.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The exit code</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


702
703
704
705</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 702</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sh'>sh</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="" title="Toys::StandardMixins::Exec (module)">Exec</a></span></span><span class='period'>.</span><span class='id identifier rubyid__setup_exec_opts'>_setup_exec_opts</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="#KEY-constant" title="Toys::StandardMixins::Exec::KEY (constant)">KEY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_sh'>sh</span><span class='lparen'>(</span><span class='id identifier rubyid_cmd'>cmd</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="verbosity_flags-instance_method">
  
    #<strong>verbosity_flags</strong>(short: false)  &#x21d2; <tt>Array&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns an array of standard verbosity flags needed to replicate the
current verbosity level. This is useful when you want to spawn tools
with the same verbosity level as the current tool.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>short</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Whether to emit short rather than long flags.
Default is false.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/toys/standard_mixins/exec.rb', line 729</span>

<span class='kw'>def</span> <span class='id identifier rubyid_verbosity_flags'>verbosity_flags</span><span class='lparen'>(</span><span class='label'>short:</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_verbosity'>verbosity</span> <span class='op'>=</span> <span class='kw'>self</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Context.html" title="Toys::Context (class)">Context</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Context/Key.html" title="Toys::Context::Key (module)">Key</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Context/Key.html#VERBOSITY-constant" title="Toys::Context::Key::VERBOSITY (constant)">VERBOSITY</a></span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_verbosity'>verbosity</span><span class='period'>.</span><span class='id identifier rubyid_positive?'>positive?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_short'>short</span>
      <span class='id identifier rubyid_flag'>flag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>v</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_verbosity'>verbosity</span>
      <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_flag'>flag</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_verbosity'>verbosity</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--verbose</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_verbosity'>verbosity</span><span class='period'>.</span><span class='id identifier rubyid_negative?'>negative?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_short'>short</span>
      <span class='id identifier rubyid_flag'>flag</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>q</span><span class='tstring_end'>&quot;</span></span> <span class='op'>*</span> <span class='op'>-</span><span class='id identifier rubyid_verbosity'>verbosity</span>
      <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_flag'>flag</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='op'>::</span><span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='op'>-</span><span class='id identifier rubyid_verbosity'>verbosity</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>--quiet</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jan  4 20:01:03 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.3.0).
</div>

    </div>
  </body>
</html>