<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Toys::Middleware
  
    &mdash; Toys
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Toys::Middleware";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Toys.html" title="Toys (module)">Toys</a></span></span>
     &raquo; 
    <span class="title">Middleware</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: Toys::Middleware
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="Middleware/Base.html" title="Toys::Middleware::Base (class)">Base</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>core-docs/toys/middleware.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p><strong><em>Defined in the toys-core gem</em></strong></p>

<p>A middleware is an object that has the opportunity to alter the
configuration and runtime behavior of each tool in a Toys CLI. A CLI
contains an ordered list of middleware, known as the <em>middleware stack</em>,
that together define the CLI&#39;s default behavior.</p>

<p>Specifically, a middleware can perform two functions.</p>

<p>First, it can modify the configuration of a tool. After tools are defined
from configuration, the middleware stack can make modifications to each
tool. A middleware can add flags and arguments to the tool, modify the
description, or make any other changes to how the tool is set up.</p>

<p>Second, a middleware can intercept and change tool execution. Like a Rack
middleware, a Toys middleware can wrap execution with its own code,
replace it outright, or leave it unmodified.</p>

<p>Generally, a middleware is a class that implements one or more of the
methods defined in this module: <span class='object_link'><a href="#config-instance_method" title="Toys::Middleware#config (method)">#config</a></span>, and
<span class='object_link'><a href="#run-instance_method" title="Toys::Middleware#run (method)">#run</a></span>. This module provides default implementations that
do nothing, but using them is not required. Middleware objects need respond
only to methods they care about.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Middleware/Base.html" title="Toys::Middleware::Base (class)">Base</a></span>, <span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Spec</a></span>, <span class='object_link'><a href="Middleware/Stack.html" title="Toys::Middleware::Stack (class)">Stack</a></span>
    
  
</p>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#spec-class_method" title="spec (class method)">.<strong>spec</strong>(middleware, *args, **kwargs, &amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a middleware spec.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stack-class_method" title="stack (class method)">.<strong>stack</strong>(input)  &#x21d2; Toys::Middleware::Stack </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a <span class='object_link'><a href="Middleware/Stack.html" title="Toys::Middleware::Stack (class)">Stack</a></span> from an array of middleware specs.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#config-instance_method" title="#config (instance method)">#<strong>config</strong>(tool, loader)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This method is called <em>after</em> a tool has been defined, and gives this middleware the opportunity to modify the tool definition.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">#<strong>run</strong>(context)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This method is called when the tool is run.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="spec-class_method">
  
    
      <span class="overload">.<strong>spec</strong>(name, *args, **kwargs, &amp;block)  &#x21d2; <tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt> </span>
    
      <span class="overload">.<strong>spec</strong>(array)  &#x21d2; <tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt> </span>
    
      <span class="overload">.<strong>spec</strong>(middleware_object)  &#x21d2; <tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt> </span>
    
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create a middleware spec.</p>


  </div>
</div>
<div class="tags">
  
  <p class="tag_title">Overloads:</p>
  <ul class="overload">
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spec</strong>(name, *args, **kwargs, &amp;block)  &#x21d2; <tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    <p>Create a spec indicating a given middleware name should be
instantiated with the given arguments.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>, <tt>Class</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The middleware name or class</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The arguments to pass to the constructor</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>kwargs</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The keyword arguments to pass to the constructor</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'>(<tt>Proc</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The block to pass to the constructor</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A spec</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spec</strong>(array)  &#x21d2; <tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    <p>Create a middleware spec from an array specification.</p>

<p>The array must be 1-4 elements long. The first element must be the
middleware name or class. The other three arguments may include any
or all of the following optional elements, in any order:</p>

<ul>
<li> An array for the positional arguments to pass to the constructor</li>
<li> A hash for the keyword arguments to pass to the constructor</li>
<li> A proc for the block to pass to the constructor</li>
</ul>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>array</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The array input</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A spec</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
      
      <li class="overload_item">
        <span class="signature">.<strong>spec</strong>(middleware_object)  &#x21d2; <tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt> </span>
        <div class="docstring">
  <div class="discussion">
    <p>Create a spec wrapping an existing middleware object</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>middleware_object</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Toys::Middleware (module)">Toys::Middleware</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The middleware object</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A spec</p>
</div>
      
    </li>
  
</ul>

</div>
      </li>
    
  </ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'core-docs/toys/middleware.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_spec'>spec</span><span class='lparen'>(</span><span class='id identifier rubyid_middleware'>middleware</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>**</span><span class='id identifier rubyid_kwargs'>kwargs</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='comment'># Source available in the toys-core gem
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stack-class_method">
  
    .<strong>stack</strong>(input)  &#x21d2; <tt><span class='object_link'><a href="Middleware/Stack.html" title="Toys::Middleware::Stack (class)">Toys::Middleware::Stack</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create a <span class='object_link'><a href="Middleware/Stack.html" title="Toys::Middleware::Stack (class)">Stack</a></span> from an array of middleware specs.
Each element may be one of the following:</p>

<ul>
<li> A <span class='object_link'><a href="" title="Toys::Middleware (module)">Toys::Middleware</a></span> object</li>
<li> A <span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Spec</a></span></li>
<li> An array whose first element is a middleware name or class, and the
subsequent elements are params that define what to pass to the class
constructor (see <span class='object_link'><a href="#spec-class_method" title="Toys::Middleware.spec (method)">spec</a></span>)</li>
</ul>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="" title="Toys::Middleware (module)">Toys::Middleware</a></span>,<span class='object_link'><a href="Middleware/Spec.html" title="Toys::Middleware::Spec (class)">Toys::Middleware::Spec</a></span>,Array&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Middleware/Stack.html" title="Toys::Middleware::Stack (class)">Toys::Middleware::Stack</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


123
124
125</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'core-docs/toys/middleware.rb', line 123</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stack'>stack</span><span class='lparen'>(</span><span class='id identifier rubyid_input'>input</span><span class='rparen'>)</span>
  <span class='comment'># Source available in the toys-core gem
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="config-instance_method">
  
    #<strong>config</strong>(tool, loader)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>This method is called <em>after</em> a tool has been defined, and gives this
middleware the opportunity to modify the tool definition. It is passed
the tool definition object and the loader, and can make any changes to
the tool definition. In most cases, this method should also call
<code>yield</code>, which passes control to the next middleware in the stack. A
middleware can disable modifications done by subsequent middleware by
omitting the <code>yield</code> call, but this is uncommon.</p>

<p>This basic implementation does nothing and simply yields to the next
middleware.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>tool</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ToolDefinition.html" title="Toys::ToolDefinition (class)">Toys::ToolDefinition</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The tool definition to modify.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>loader</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Loader.html" title="Toys::Loader (class)">Toys::Loader</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The loader that loaded this tool.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'core-docs/toys/middleware.rb', line 44</span>

<span class='kw'>def</span> <span class='id identifier rubyid_config'>config</span><span class='lparen'>(</span><span class='id identifier rubyid_tool'>tool</span><span class='comma'>,</span> <span class='id identifier rubyid_loader'>loader</span><span class='rparen'>)</span>
  <span class='comment'># Source available in the toys-core gem
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run-instance_method">
  
    #<strong>run</strong>(context)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p><p>This method is called when the tool is run. It gives the middleware an
opportunity to modify the runtime behavior of the tool. It is passed
the tool instance (i.e. the object that hosts a tool&#39;s <code>run</code> method),
and you can use this object to access the tool&#39;s options and other
context data. In most cases, this method should also call <code>yield</code>,
which passes control to the next middleware in the stack. A middleware
can &quot;wrap&quot; normal execution by calling <code>yield</code> somewhere in its
implementation of this method, or it can completely replace the
execution behavior by not calling <code>yield</code> at all.</p>

<p>Like a tool&#39;s <code>run</code> method, this method&#39;s return value is unused. If
you want to output from a tool, write to stdout or stderr. If you want
to set the exit status code, call <span class='object_link'><a href="Context.html#exit-instance_method" title="Toys::Context#exit (method)">Context#exit</a></span> on the context.</p>

<p>This basic implementation does nothing and simply yields to the next
middleware.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>context</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Context.html" title="Toys::Context (class)">Toys::Context</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The tool execution context.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'core-docs/toys/middleware.rb', line 69</span>

<span class='kw'>def</span> <span class='id identifier rubyid_run'>run</span><span class='lparen'>(</span><span class='id identifier rubyid_context'>context</span><span class='rparen'>)</span>
  <span class='comment'># Source available in the toys-core gem
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jun 29 00:53:09 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-2.7.8).
</div>

    </div>
  </body>
</html>